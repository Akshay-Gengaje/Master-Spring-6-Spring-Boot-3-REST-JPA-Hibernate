# RequestEntity

In Spring Boot, **RequestEntity** is a class used to represent an HTTP request, including the request body, headers, and method. It is a more comprehensive representation of an incoming request compared to simply using method parameters like `@RequestBody` or `@RequestHeader`. This allows for more control over handling the incoming HTTP request data in your application.

Just as `ResponseEntity` wraps the HTTP response, `RequestEntity` wraps the HTTP request. You can use it to capture all aspects of an HTTP request in a single object, such as the method (GET, POST, etc.), headers, and body, when interacting with a REST controller.

### Key Components of `RequestEntity`:

1. **HTTP Method**: The HTTP verb of the request (e.g., GET, POST, PUT, DELETE).
2. **Request Headers**: Contains the headers sent by the client.
3. **Request Body**: The body of the request (e.g., JSON, XML, or form data).
4. **URI**: The target URI of the request.

### Constructor for `RequestEntity`

The `RequestEntity` class can be constructed manually or retrieved in a controller method that handles an HTTP request.

```java
public class RequestEntity<T> extends HttpEntity<T>
```

Here, `T` is the type of the request body.

---

### Example Usage of `RequestEntity`

#### 1. Using `RequestEntity` in a Controller

You can use `RequestEntity` in a controller to gain full access to the HTTP request, including its body, headers, and HTTP method.

```java
import org.springframework.http.RequestEntity;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

@RestController
@RequestMapping("/api")
public class RequestEntityController {

    @PostMapping("/process")
    public ResponseEntity<String> handleRequest(RequestEntity<String> requestEntity) {
        // Get HTTP method
        String method = requestEntity.getMethod().toString();

        // Get Headers
        String headers = requestEntity.getHeaders().toString();

        // Get Request Body
        String body = requestEntity.getBody();

        // Get URI
        String uri = requestEntity.getUrl().toString();

        String responseMessage = "Method: " + method + "\nHeaders: " + headers + "\nBody: " + body + "\nURI: " + uri;

        return ResponseEntity.ok(responseMessage);
    }
}
```

In this example:

- The HTTP method can be accessed using `requestEntity.getMethod()`.
- The request headers can be accessed using `requestEntity.getHeaders()`.
- The request body can be accessed using `requestEntity.getBody()`.
- The URI can be retrieved via `requestEntity.getUrl()`.

#### 2. Making an HTTP Request Using `RequestEntity`

`RequestEntity` is also useful when using `RestTemplate` to make a request to another service. You can construct a `RequestEntity` to send the request along with custom headers, body, and HTTP method.

```java
import org.springframework.http.HttpMethod;
import org.springframework.http.RequestEntity;
import org.springframework.http.ResponseEntity;
import org.springframework.web.client.RestTemplate;

import java.net.URI;

public class RequestEntityExample {

    public static void makeRequest() {
        RestTemplate restTemplate = new RestTemplate();

        // Creating the URI for the request
        URI uri = URI.create("https://jsonplaceholder.typicode.com/posts");

        // Creating the RequestEntity with HTTP method, headers, and body
        RequestEntity<String> requestEntity = RequestEntity
            .post(uri)  // HTTP POST method
            .header("Content-Type", "application/json")
            .body("{\"title\": \"foo\", \"body\": \"bar\", \"userId\": 1}");

        // Making the request and capturing the response
        ResponseEntity<String> response = restTemplate.exchange(requestEntity, String.class);

        System.out.println("Response: " + response.getBody());
    }
}
```

In this example:

- We create a `RequestEntity` for a POST request with a JSON body.
- The `RestTemplate.exchange()` method is used to make the HTTP request using the `RequestEntity`.

#### 3. Using `RequestEntity` with Custom Headers

You can use `RequestEntity` to capture custom headers sent by the client.

```java
import org.springframework.http.HttpHeaders;
import org.springframework.http.RequestEntity;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

@RestController
@RequestMapping("/api")
public class HeaderController {

    @PostMapping("/headers")
    public ResponseEntity<String> handleHeaders(RequestEntity<String> requestEntity) {
        HttpHeaders headers = requestEntity.getHeaders();

        // Check if a specific custom header is present
        String customHeader = headers.getFirst("X-Custom-Header");

        return ResponseEntity.ok("Received custom header: " + customHeader);
    }
}
```

---

### When to Use `RequestEntity`

- **Accessing Request Metadata**: If you need access to not only the request body but also the headers, HTTP method, or URI, `RequestEntity` is useful.
- **Custom HTTP Clients**: When using `RestTemplate` or `WebClient` to make custom HTTP requests, `RequestEntity` can define the request configuration (e.g., headers, body, method).
- **Complex Requests**: If your endpoint needs to handle different HTTP methods or you want to perform custom operations based on request headers or URIs, `RequestEntity` offers more flexibility.

### Differences Between `RequestEntity` and Other Spring Annotations

- **`@RequestBody`**: Only extracts the body of the request. It does not provide access to the headers, URI, or HTTP method.
- **`@RequestHeader`**: Specifically used for extracting headers but does not provide access to the request body or method.
- **`RequestEntity`**: Provides a complete representation of the entire request (headers, body, method, URI).

### Benefits of `RequestEntity`

- **Full control**: It allows you to handle and inspect every aspect of the HTTP request.
- **Versatility**: You can use it for both server-side handling of incoming requests and client-side construction of outgoing requests (with `RestTemplate` or `WebClient`).

---

Using `RequestEntity` in Spring Boot gives you a powerful tool to handle complex request scenarios by providing access to all parts of the HTTP request in one place.
